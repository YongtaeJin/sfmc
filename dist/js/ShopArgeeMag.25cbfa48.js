(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["ShopArgeeMag"],{a2e4:function(t,e,a){"use strict";var i=function(){var t=this,e=t._self._c;return e("v-dialog",t._b({model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},"v-dialog",t.$attrs,!1),[e("v-card",[e("v-toolbar",[e("v-toolbar-title",[t._v(t._s(t.label))]),e("v-spacer"),e("v-btn",{attrs:{icon:""},on:{click:t.close}},[e("v-icon",[t._v("mdi-close")])],1)],1),e("v-card-text",[t._t("default")],2)],1)],1)},s=[],n={name:"ezDialog",props:{label:{type:String,required:!0}},data(){return{dialog:!1}},methods:{close(){this.dialog=!1,this.$emit("onClose")},open(){this.$emit("onOpen"),this.dialog=!0}}},l=n,r=a("2877"),o=Object(r["a"])(l,i,s,!1,null,null,null);e["a"]=o.exports},c60b:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t._self._c;return e("v-container",{attrs:{fluid:""}},[e("v-toolbar",[e("v-toolbar-title",[t._v("협약서관리")]),e("v-spacer"),e("v-text-field",{attrs:{label:"업체명 : ","hide-details":"","single-lin":""},model:{value:t.chkf_serarch,callback:function(e){t.chkf_serarch=e},expression:"chkf_serarch"}}),e("v-radio-group",{staticClass:"small-radio no-space",attrs:{inline:"",label:"협약서 :",row:"","hide-details":""},model:{value:t.chkf_arfe,callback:function(e){t.chkf_arfe=e},expression:"chkf_arfe"}},[e("v-radio",{attrs:{label:"전체",value:"%"}}),e("v-radio",{attrs:{label:"완료",value:"Y"}}),e("v-radio",{attrs:{label:"미완료",value:"N"}})],1),e("v-btn",{attrs:{color:"primary"},on:{click:t.fetchData}},[t._v("조회")])],1),e("v-data-table",{staticClass:"elevation-1 mytable mytableTd",attrs:{headers:t.headers,items:t.itemArgee,"items-per-page":20,"footer-props":{"items-per-page-options":[10,20,30,40,50,100,-1]}},scopedSlots:t._u([{key:"item",fn:function({item:a}){return[e("tr",[e("td",{on:{dblclick:function(e){return t.showRowInfo(a)}}},[e("u",[t._v(t._s(a.n_company))])]),a.rnum>=1?e("td",{class:{greencol:a.t1},attrs:{align:"center"}},[t._v(" "+t._s(t.datachk(a.t1)))]):t._e(),a.rnum>=2?e("td",{class:{greencol:a.t2},attrs:{align:"center"}},[t._v(" "+t._s(t.datachk(a.t2)))]):t._e(),a.rnum>=3?e("td",{class:{greencol:a.t3},attrs:{align:"center"}},[t._v(" "+t._s(t.datachk(a.t3)))]):t._e(),a.rnum>=4?e("td",{class:{greencol:a.t4},attrs:{align:"center"}},[t._v(" "+t._s(t.datachk(a.t4)))]):t._e(),a.rnum>=5?e("td",{class:{greencol:a.t5},attrs:{align:"center"}},[t._v(" "+t._s(t.datachk(a.t5)))]):t._e(),a.rnum>=6?e("td",{class:{greencol:a.t6},attrs:{align:"center"}},[t._v(" "+t._s(t.datachk(a.t6)))]):t._e(),a.rnum>=7?e("td",{class:{greencol:a.t7},attrs:{align:"center"}},[t._v(" "+t._s(t.datachk(a.t7)))]):t._e(),a.rnum>=8?e("td",{class:{greencol:a.t8},attrs:{align:"center"}},[t._v(" "+t._s(t.datachk(a.t8)))]):t._e(),a.rnum>=9?e("td",{class:{greencol:a.t9},attrs:{align:"center"}},[t._v(" "+t._s(t.datachk(a.t9)))]):t._e(),a.rnum>=10?e("td",{class:{greencol:a.t10},attrs:{align:"center"}},[t._v(" "+t._s(t.datachk(a.t10)))]):t._e(),a.rnum>=11?e("td",{class:{greencol:a.t11},attrs:{align:"center"}},[t._v(" "+t._s(t.datachk(a.t11)))]):t._e(),a.rnum>=12?e("td",{class:{greencol:a.t12},attrs:{align:"center"}},[t._v(" "+t._s(t.datachk(a.t12)))]):t._e(),a.rnum>=13?e("td",{class:{greencol:a.t13},attrs:{align:"center"}},[t._v(" "+t._s(t.datachk(a.t13)))]):t._e(),a.rnum>=14?e("td",{class:{greencol:a.t14},attrs:{align:"center"}},[t._v(" "+t._s(t.datachk(a.t14)))]):t._e(),a.rnum>=15?e("td",{class:{greencol:a.t15},attrs:{align:"center"}},[t._v(" "+t._s(t.datachk(a.t15)))]):t._e(),a.rnum>=16?e("td",{class:{greencol:a.t16},attrs:{align:"center"}},[t._v(" "+t._s(t.datachk(a.t16)))]):t._e(),a.rnum>=17?e("td",{class:{greencol:a.t17},attrs:{align:"center"}},[t._v(" "+t._s(t.datachk(a.t17)))]):t._e(),a.rnum>=18?e("td",{class:{greencol:a.t18},attrs:{align:"center"}},[t._v(" "+t._s(t.datachk(a.t18)))]):t._e(),a.rnum>=19?e("td",{class:{greencol:a.t19},attrs:{align:"center"}},[t._v(" "+t._s(t.datachk(a.t19)))]):t._e(),a.rnum>=20?e("td",{class:{greencol:a.t20},attrs:{align:"center"}},[t._v(" "+t._s(t.datachk(a.t20)))]):t._e(),e("td",{class:{greencol:a.f_argeechk},attrs:{align:"center"},on:{dblclick:function(e){return t.f_argeechk(a)}}},[e("u",[t._v(t._s(t.argeechk(a.f_argeechk)))])])])]}}])}),e("ez-dialog",{ref:"dialog",attrs:{label:"협약서 서류 확인","max-width":"800",color:"primary",persistent:""}},[e("shop-argeemag-01-form",{attrs:{fileLists:t.fileItem,companyName:this.n_company},on:{process:t.saveDocProcess,mailSend:t.mailSend}})],1),e("tiptab-mail",{ref:"dialog2",attrs:{label:"메일발송",body_content:this.form.body,mail_title:this.form.title,itemInput:this.fileItem,"max-width":"900","max-height":"1300",persistent:""},on:{onSend:t.sendMail}}),e("ez-dialog-2",{ref:"ez_wait",attrs:{label:"처리중","max-width":"200",persistent:"",color:"primary"}})],1)},s=[],n=(a("14d9"),a("64f2")),l=a("2f62"),r=a("a2e4"),o=function(){var t=this,e=t._self._c;return e("v-form",{ref:"form"},[e("v-toolbar",{attrs:{"background-color":"primary",dark:""}},[t.fileLists.length?e("v-btn",{attrs:{color:"primary"},on:{click:t.process}},[t._v("서류처리")]):t._e(),t.fileLists.length?e("v-btn",{attrs:{color:"primary"},on:{click:t.mailSend}},[t._v("메일발송")]):t._e(),e("v-spacer"),t.fileLists.length?e("v-checkbox",{staticClass:"mx-4",attrs:{label:"서류명","hide-details":"",color:"primary"},model:{value:t.f_downchk2,callback:function(e){t.f_downchk2=e},expression:"f_downchk2"}}):t._e(),t.fileLists.length?e("v-btn",{attrs:{color:"primary"},on:{click:t.alldownLoad}},[t._v("일과 내려받기")]):t._e()],1),e("v-data-table",{staticClass:"mytable",attrs:{headers:t.fileHeaders,items:t.inputfilelist},scopedSlots:t._u([{key:"item",fn:function({item:a}){return[e("tr",[e("td",{attrs:{align:"center"}},[t._v(" "+t._s(a.i_sort)+" ")]),e("td",{attrs:{align:"center"}},[t._v(" "+t._s(a.f_yn)+" ")]),e("td",[t._v(" "+t._s(a.n_nm)+" ")]),e("td",{class:{redcol:"N"==a.f_noact,greencol:"Y"==a.f_noact,bluecol:"I"==a.f_noact},attrs:{align:"center"},on:{dblclick:function(e){return t.docProcess(a)}}},[e("u",[t._v(t._s(t.f_noact(a.f_noact)))])]),e("td",[t._v(" "+t._s(a.n_file)+" ")]),e("td",[t._v(" "+t._s(a.n_filename)+" ")]),e("td",{attrs:{align:"center"}},[a.n_filename?e("v-btn",{attrs:{fab:"","x-small":""},on:{click:function(e){return t.onDownLoad(a)}}},[e("v-icon",{attrs:{dark:""}},[t._v("mdi-file-download")])],1):t._e()],1)])]}}])})],1)},c=[],h=a("9e7e"),_={name:"Shopinputmag03Form",props:{fileLists:{type:Object,default:null},companyName:null},data(){return{fileHeaders:[{text:"순번",value:"i_sort",sortable:!1,align:"center",width:"55px"},{text:"필수",value:"f_yn",sortable:!1,align:"center",width:"75px"},{text:"명칭",value:"n_nm",sortable:!1},{text:"서류",value:"f_noact",sortable:!1,align:"center",width:"55px"},{text:"첨부서류",value:"n_file",sortable:!1},{text:"첨부파일명",value:"n_filename",sortable:!1},{text:"DOWN",value:"t_att",sortable:!1,align:"center",width:"75px"}],inputfilelist:[],f_downchk2:0}},created(){this.init()},watch:{fileLists(){this.init()}},methods:{async init(){this.fileLists&&(this.inputfilelist=await this.$axios.get(`/api/shopinfo/getShopArgeeInDetail?i_shop=${this.fileLists.i_shop}&i_no=${this.fileLists.i_no}`))},f_noact(t){return"I"==t?"등록":"Y"==t?"확인":"N"==t?"반려":"R"==t?"수정":""},async onDownLoad(t){t.t_att;const e=t.n_filename,a=await this.$axios.get("/api/shopinfo/getFileDown?path="+t.t_att);a?(Object(h["save"])(a,e),alert("File Donw load Click !!!!!")):await this.$ezNotify.alert("다운로드 실패 !!","오류")},async alldownLoad(){a("df7c");let t="1";if(this.f_downchk2&&(t="2"),this.inputfilelist){const e=await this.$axios.get(`/api/shopinfo/getFileDownZip?i_shop=${this.inputfilelist[0].i_shop}&i_no=${this.inputfilelist[0].i_no}&f_gubun=${this.inputfilelist[0].f_gubun}&f_filetype=${t}`);e?(Object(h["save"])(e,this.companyName+".zip"),alert("File Donw load Click !!!!!")):await this.$ezNotify.alert("다운로드 실패 !!","오류")}},async docProcess(t){t.f_noact&&(t.f_noact="Y"==t.f_noact?"N":"Y",t.f_edit=!0)},async process(){this.$emit("process",this.inputfilelist)},async mailSend(){this.$emit("mailSend",this.inputfilelist)}}},f=_,d=a("2877"),p=Object(d["a"])(f,o,c,!1,null,null,null),m=p.exports,u=a("a01d"),g=a("0e60"),v={components:{EzDialog:r["a"],ShopArgeemag01Form:m,TiptabMail:u["a"],EzDialog2:g["a"]},name:"ShopArgeeMag",title:"사업협약서관리",data(){return{headers:[],itemArgee:[],chkf_arfe:"%",chkf_serarch:"",rnum:null,fileItem:[],n_company:null,form:{title:"",to_email:"",cc_email:"",body:""}}},created(){this.rnum=1,this.init()},mounted(){window.addEventListener("beforeunload",this.leave)},beforeUnmount(){window.removeEventListener("beforeunload",this.leave)},methods:{...Object(l["b"])("shop",["shopEmailSend"]),leave(t){t.preventDefault(),t.returnValue=""},datachk(t){let e="";return e=t?"완료":"미완료",e},argeechk(t){return"Y"==t?"확인":"미확인"},async init(){this.rnum=1,this.fetchData()},async fetchData(){const t={};if(this.headers.splice(0),t.text="업체명",t.value="n_company",t.sortable=!1,t.align="center",this.headers.push({...t}),this.itemArgee=await this.$axios.get(`/api/shopinfo/getShopArgeeMag?i_shop=23-001&f_serarch=${this.chkf_serarch}&chkf_arfe=${this.chkf_arfe}`),this.itemArgee){this.rnum=this.itemArgee[0].rnum;for(let e=0;e<Object.keys(this.itemArgee[0]).length;e++){let a=Object.keys(this.itemArgee[0])[e],i=this.itemArgee[0][a];"h"==a[0]&&this.rnum>=Object(n["extractNumber"])(a)&&(t.text=i,t.value="t"+Object(n["extractNumber"])(a),t.sortable=!1,t.align="center",this.headers.push({...t}))}t.text="확인",t.value="f_argeechk",t.sortable=!1,t.align="center",this.headers.push({...t})}},async f_argeechk(t){const e=await this.$ezNotify.confirm("처리 하시겠습니까  ?","협약서");if(e)if("Y"==t.f_argeechk)t.f_argeechk="N";else{t.f_argeechk="Y";await this.$axios.patch(`/api/shopinfo/getShopInputMag?i_shop=${t.i_shop}&i_no=${t.i_no}&f_argeechk=${t.f_argeechk}`)}},async showRowInfo(t){this.n_company=t.n_company,this.fileItem=Object(n["deepCopy"])(t),this.$refs.dialog.open()},async saveDocProcess(t){for(let e in t)if(t[e].f_edit){this.$axios.patch(`/api/shopinfo/ShopInputMag2Save?i_shop=${t[e].i_shop}&i_no=${t[e].i_no}&i_ser=${t[e].i_ser}&f_noact=${t[e].f_noact}`)}},async mailSend(t){if(t){this.form.title="스마트공방 협약서 서류 확인 안내";let e="<p>상기 제목 관련 하여 아래와 같이 첨부 서류 확인 결과 전달 드립니다.</p><p>";e+="공방 협약서 서류</p>",t.forEach(t=>{let a="Y"==t.f_noact?"접수":"N"==t.f_noact?"반려":"I"==t.f_noact||"R"==t.f_noact?"검토":"미등록";e+=`<p>${"Y"==t.f_noact?"":'<span style="color:red"'}>${t.n_file} : 서류${a}${"Y"==t.f_noact?"":"</span>"}</p>`}),e+="<p>반려된 첨부서류에 대해서 재 등록 부탁 드립니다.</p>",e+="<p></p>감사 합니다.",this.form.body=e,this.$refs.dialog2.open()}},async getEmail(t){let e="";"U"==t?e=`/api/shopinfo/shopgetEmail?i_userid=${this.itemInput.i_userid}&gubun=${t}`:(t="S")?e=`/api/shopinfo/shopgetEmail?i_shop=${this.itemInput.i_shop}&i_no=${this.itemInput.i_no}&gubun=${t}`:(t="M")&&(e="/api/shopinfo/shopgetEmail?&gubun=TOKEN");const a=await this.$axios.get(e);a&&(this.form.to_email=a[0].to_email);const i=await this.$axios.get("/api/shopinfo/shopgetEmail?&gubun=TOKEN");i&&(this.form.cc_email=i[0].to_email)},async sendMail(t,e,a,i){this.$refs.ez_wait.open(),this.form.title=t,this.form.to_email=e,this.form.cc_email=a,this.form.body=i;const s=await this.shopEmailSend(this.form);this.$refs.ez_wait.close(),"ok"==s&&(this.$ezNotify.alert("정상적으로 메일 발송 하였습니다..... ","성공"),this.$refs.dialog2.close())}}},b=v,k=Object(d["a"])(b,i,s,!1,null,null,null);e["default"]=k.exports}}]);
//# sourceMappingURL=ShopArgeeMag.25cbfa48.js.map